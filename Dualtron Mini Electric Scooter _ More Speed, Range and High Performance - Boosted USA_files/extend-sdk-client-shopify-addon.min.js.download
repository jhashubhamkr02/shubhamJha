/*!
 * Copyright (c) 2019-present, Extend, Inc.
 * version: 1.6.49
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ExtendShopify=t():e.ExtendShopify=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapCallback=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t&&console.error(t),"function"==typeof e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.apply(void 0,[t||null].concat(r))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchErrorEvent=function(e){var t=e.type,n=e.error,r=e.sdkName,o=document.createEvent("CustomEvent");o.initCustomEvent("_extend:errorTrackEvent",!0,!0,{type:t,error:n,sdkName:r}),window.dispatchEvent(o)},t.ERROR_TRACK_EVENT=void 0;t.ERROR_TRACK_EVENT="_extend:errorTrackEvent"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offerConfigurationGateway=i,t.extendConfigurationGateway=a,t.extendVersionFromConfig=function(){return i().loadConfiguration(u()).then((function(e){return e.extendVersion()}))},t.extendOfferTypeFromConfig=function(){return i().loadConfiguration(u()).then((function(e){return e.getOffersType()}))},t.storeIdFromConfig=u;var r=n(26),o=n(27);function i(){return new o.ExtendSdkOfferConfigurationGateway}function a(){return new r.ExtendSdkExtendConfigurationGateway}function u(){return a().loadConfiguration().storeId()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addVariantToCart=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0;return(0,r.request)("/cart/add.js",{method:"POST",body:JSON.stringify({quantity:o,id:n,properties:i({"__Extend.IsExtendWarranty":!0,"Extend.LeadToken":a,"Extend.LeadQuantity":a?o:void 0,"__Extend.OfferPlanId":t.offerId},u)})})},t.getProduct=function(e){return(0,r.request)("/products/".concat(e)).then(c)},t.addShippingProtectionToCart=function(e,t){return(0,r.request)("/cart/add.js",{method:"POST",body:JSON.stringify({id:e,quantity:1,properties:{"Extend.IsShippingProtection":!0,"Extend.ShippingQuoteId":t}})})},t.addShippingProtectionToCartUpdated=function(e,t){return(0,r.request)("/cart/add.js",{method:"POST",body:JSON.stringify({id:e,quantity:1,properties:{"Extend.IsShippingProtection":!0,"Extend.ShippingQuoteId":t}})}).then(d)},t.getCart=function(){return(0,r.request)("/cart.js").then(u)},t.updateCartItems=function(e){return(0,r.request)("/cart/update.js",{method:"POST",body:JSON.stringify({updates:e})}).then(u)};var r=n(4);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){if(!e.data||!e.data.token)throw new Error("Unable to retrieve cart data");return e.data}function c(e){if(!e.data||!e.data.product)throw new Error("Unable to retrieve product data");return e.data.product}function d(e){if(!e.data)throw new Error("Unable to retrieve added sp product data");return e.data}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.request=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new o.default((function(n,r){var o=new XMLHttpRequest,c=t.method||"GET";o.addEventListener("load",(function(){var r=a(o.response);o.status>=400&&(0,i.dispatchErrorEvent)({type:t.extendRequest?"extend_api_error":"shopify_api_error",error:{statusCode:o.status,requestUrl:e,requestParams:t,responseBody:r},sdkName:"extend-sdk-client-shopify-addon"}),n({status:o.status,data:r})})),o.addEventListener("error",(function(n){var u=a(o.response);(0,i.dispatchErrorEvent)({type:t.extendRequest?"extend_api_error":"shopify_api_error",error:{statusCode:o.status,requestUrl:e,requestParams:t,responseBody:u},sdkName:"extend-sdk-client-shopify-addon"}),r(n)})),o.open(c,"GET"===c?u(e):e,!0),o.setRequestHeader("Accept","application/json"),t.body&&o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.withCredentials=!0,o.send(t.body)}))},t._parseResponse=void 0;var r,o=(r=n(7))&&r.__esModule?r:{default:r},i=n(1);function a(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function u(e){return e.indexOf("?")>0?"".concat(e,"&ts=").concat(Date.now()):"".concat(e,"?ts=").concat(Date.now())}var c=a;t._parseResponse=c},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.OfferSyncType=void 0,t.OfferSyncType=r,function(e){e.off="off",e.directMap="directMap",e.pricePoints="pricePoints"}(r||(t.OfferSyncType=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SP_PLAN_ADDED_TO_CART=t.SP_PLAN_ADDED_TO_CART_FOR_UPDATE_EXTEND_LINE_ITEMS=t.SP_PLAN_ADDED_TO_CART_FOR_UPDATE=t.SP_PLAN_REMOVED_FROM_CART_BY_USER=t.SP_PLAN_REMOVED_FROM_CART_FOR_UPDATE=t.SP_PLAN_PRODUCT_VARIANT_FOUND=t.SP_PLAN_PRODUCT_VARIANT_NOT_FOUND=t.SP_PLANS_FROM_098_TO_27=t.SP_PLANS_FROM_28_TO_270=t.SP_PLANS_FROM_280_TO_1270=t.SP_PLANS_FROM_1280_TO_2250=void 0;t.SP_PLANS_FROM_1280_TO_2250="extend-shipping-protection-plans-1280-00";t.SP_PLANS_FROM_280_TO_1270="extend-shipping-protection-plans-280-00";t.SP_PLANS_FROM_28_TO_270="extend-shipping-protection-plans-28-00";t.SP_PLANS_FROM_098_TO_27="extend-shipping-protection-plans-0-98";t.SP_PLAN_PRODUCT_VARIANT_NOT_FOUND="Shipping Protection variant not found";t.SP_PLAN_PRODUCT_VARIANT_FOUND="Shipping Protection variant found";t.SP_PLAN_REMOVED_FROM_CART_FOR_UPDATE="SP Line Item Removed from Cart for update";t.SP_PLAN_REMOVED_FROM_CART_BY_USER="SP Plan Item removed from Cart by user";t.SP_PLAN_ADDED_TO_CART_FOR_UPDATE="SP Line Item added to Cart for update";t.SP_PLAN_ADDED_TO_CART_FOR_UPDATE_EXTEND_LINE_ITEMS="SP Line Item added to Cart for updateExtendLineItems";t.SP_PLAN_ADDED_TO_CART="SP Line Item added to Cart"},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(31)),o=i(n(32));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function d(){}function s(e){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(e,this)}function f(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,s._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void p(t.promise,e)}l(t.promise,r)}else(1===e._state?l:p)(t.promise,e._value)}))):e._deferreds.push(t)}function l(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===a(t)||"function"==typeof t)){var n=t.then;if(t instanceof s)return e._state=3,e._value=t,void y(e);if("function"==typeof n)return void m((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,y(e)}catch(t){p(e,t)}var r,o}function p(e,t){e._state=2,e._value=t,y(e)}function y(e){2===e._state&&0===e._deferreds.length&&s._immediateFn((function(){e._handled||s._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)f(e,e._deferreds[t]);e._deferreds=null}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function m(e,t){var n=!1;try{e((function(e){n||(n=!0,l(t,e))}),(function(e){n||(n=!0,p(t,e))}))}catch(e){if(n)return;n=!0,p(t,e)}}s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){var n=new this.constructor(d);return f(this,new h(e,t,n)),n},s.prototype.finally=r.default,s.all=function(e){return new s((function(t,n){if(!c(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,u){try{if(u&&("object"===a(u)||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(t){i(e,t)}),n)}r[e]=u,0==--o&&t(r)}catch(e){n(e)}}for(var u=0;u<r.length;u++)i(u,r[u])}))},s.allSettled=o.default,s.resolve=function(e){return e&&"object"===a(e)&&e.constructor===s?e:new s((function(t){t(e)}))},s.reject=function(e){return new s((function(t,n){n(e)}))},s.race=function(e){return new s((function(t,n){if(!c(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)s.resolve(e[r]).then(t,n)}))},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){u(e,0)},s._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var v=s;t.default=v}).call(this,n(28).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addVariantToCart=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4?arguments[4]:void 0;return(0,r.request)("/cart/add.js",{method:"POST",body:JSON.stringify({quantity:i,id:n,properties:{Ref:e.id,Product:e.name,Term:"".concat((0,o.getTermLengthText)(t.term)," - sold by Extend"),"Extend.LeadToken":a,"Extend.LeadQuantity":a?i:void 0,"__Extend.OfferPlanId":t.offerId}})})},t.getCart=function(){return(0,r.request)("/cart.json").then(i)},t.updateCartItems=function(e){return(0,r.request)("/cart/update.json",{method:"POST",body:JSON.stringify({updates:e})}).then(i)};var r=n(4),o=n(14);function i(e){if(!e.data||!e.data.token)throw new Error("Unable to retrieve cart data");return e.data}},function(e,t,n){"use strict";function r(e){return e.items.filter((function(e){return o(e)}))}function o(e){return Boolean(e.properties&&e.properties["Extend.IsShippingProtection"])}Object.defineProperty(t,"__esModule",{value:!0}),t.isSPPlanChangeRequired=function(e,t){var n=r(e);if(1===n.length){var o,i=n[0];if(i.price===t.premium&&(null===(o=i.properties)||void 0===o?void 0:o["Extend.ShippingQuoteId"])===t.id)return!1}return!0},t.filterShippingPlans=r,t.isSPPlan=o,t.getSPQuote=function(e){return new Promise((function(t){window.Extend.shippingProtection.getUpdatedSPQuote({items:e,onUpdate:function(e){var n=e.quote,r=e.attachBehavior;return t({quote:n,attachBehavior:r})}})}))},t.isSPInCart=function(e){return e.items.some((function(e){var t=e.properties;return t&&t["Extend.IsShippingProtection"]}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSPPlanVariant=function(e){var t=u(e.premium);return new Promise((function(n,o){return(0,i.getProduct)(t).then((function(t){if(!t||!Object.keys(t).length)return o(new Error("Shipping Protection product not found"));var i=t.variants.filter((function(t){return t.price===(0,a.formatCurrency)(e.premium)}))[0];return i?(window.Extend.trackSPVariant({variant:i,quote:e,message:r.SP_PLAN_PRODUCT_VARIANT_FOUND}),n(i.id)):(window.Extend.trackSPVariant({variant:null,quote:e,message:r.SP_PLAN_PRODUCT_VARIANT_NOT_FOUND}),o(new Error("Shipping Protection variant not found")))})).catch((function(){window.Extend.trackSPVariant({variant:null,quote:e,message:r.SP_PLAN_PRODUCT_VARIANT_NOT_FOUND}),o(new Error("Shipping Protection variant not found"))}))}))},t.getSPProductHandle=u;var r=n(6),o=n(1),i=n(3),a=n(18);function u(e){if(e<=2700)return r.SP_PLANS_FROM_098_TO_27;if(e>=2800&&e<28e3)return r.SP_PLANS_FROM_28_TO_270;if(e>=28e3&&e<128e3)return r.SP_PLANS_FROM_280_TO_1270;if(e>=128e3&&e<=225e3)return r.SP_PLANS_FROM_1280_TO_2250;throw(0,o.dispatchErrorEvent)({type:"uncaught_exception",error:{functionContext:"lib/sp-variants - getSPProductHandle"},sdkName:"extend-sdk-client-shopify-addon"}),new Error("SP Premium not supported")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreIntegrationConfig=c,t.getOfferSyncType=function(e,t){return c(e,t).then((function(e){return null!=e&&e.offerSyncType?null==e?void 0:e.offerSyncType:((0,u.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/get-offer-sync-type - getOfferSyncType",missingParams:["offerSyncType"]},sdkName:"extend-sdk-client-shopify-addon"}),i.OfferSyncType.directMap)})).catch((function(){return i.OfferSyncType.directMap}))};var r=n(4),o=n(33),i=n(5),a=n(35),u=n(1);function c(e,t){var n=(0,o.getStoreIntegrationConfigCache)(e);if(n)return Promise.resolve(n);var i="https://".concat((0,a.getExtendApiHost)(t),"/stores/").concat(e,"/integration-config");return(0,r.request)(i,{extendRequest:!0}).then((function(t){var n=t.status,r=t.data;if(200!==n||!r)throw new Error("Unable to retrieve store integration config");return(0,o.setStoreIntegrationConfigCache)(e,r),r}))}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":r(window))&&(o=window)}e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPlanToCart=function(e,t,n){var c,d,s,f,l=1,p=n;if(u(e)){c=e.plan,d=e.product;var y=e.quantity;l=void 0===y?1:y,s=e.leadToken;var h=e.offerType;f=void 0===h?{area:"cart_page",component:"modal"}:h,p=t}else d=t,c=e;var m=(0,o.wrapCallback)(p);if(!c)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-plan-to-cart - addPlanToCart",missingParams:["plan"]},sdkName:"extend-sdk-client-shopify-addon"}),void m(new Error('Missing required argument "plan" in addPlanToCart(plan, product)'));if(!d||!d.id)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-plan-to-cart - addPlanToCart",missingParams:["product"]},sdkName:"extend-sdk-client-shopify-addon"}),void m(new Error('Missing required argument "product" in addPlanToCart(plan, product)'));d.name||(console.warn("product.name was not defined. This will effect how the warranty is displayed in the cart, but will not effect functionality.  You can provide your own product.name property for the currently selected variant to prevent this issue."),d.name="Covered Product");(0,i.getPlanVariant)({planId:c.planId,price:c.price},(function(e,t){!e&&t?((0,r.addVariantToCart)(d,c,t.variantId,l,s).then((function(){m(null)})).catch(m),window.Extend.trackOfferAddedToCart({productId:d.id,planId:c.planId,warrantyQuantity:Number(l)||1,productQuantity:Number(l)||1,offerType:f})):m(e)}))},t.isCartOpts=u;var r=n(8),o=n(0),i=n(15),a=n(1);function u(e){return Boolean(e&&e.plan)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTermLengthText=function(e){return 999===e?"Lifetime":1===e?"1 month":e%12!=0?"".concat(e," months"):12===e?"1 year":"".concat(e/12," years")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanVariant=function(e,t){var n,a,u=(0,o.wrapCallback)(t);if(!e||0===Object.keys(e).length)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/get-plan-variant - getPlanVariant",missingParams:["options"]},sdkName:"extend-sdk-client-shopify-addon"}),void u(new Error("Missing argument: options"));if(e.storeId)n=e.storeId,a=e.environment||"production";else{if(void 0===window.Extend)return void u(new Error('Missing required dependency "Extend"'));var c=window.Extend.config();n=c.storeId,a=e.environment||c.environment}n?(0,r.getPlanVariantByPlanInfo)(n,e,a).then((function(e){return u(null,e)})).catch(u):((0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/get-plan-variant - getPlanVariant",missingParams:["storeId"]},sdkName:"extend-sdk-client-shopify-addon"}),u(new Error('Could not find "storeId". Did you forget to call Extend.config()?')))};var r=n(36),o=n(0),i=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPlanToCart=function(e,t,n){var l,p,y,h,m=1,v=n;if(f(e)){l=e.plan,p=e.product;var g=e.quantity;m=void 0===g?1:g,y=e.leadToken;var _=e.offerType;h=void 0===_?{area:"cart_page",component:"modal"}:_,v=t}else p=t,l=e;var P=(0,o.wrapCallback)(v);if(!l)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-plan-to-cart - addPlanToCart",missingParams:["plan"]},sdkName:"extend-sdk-client-shopify-addon"}),void P(new Error('Missing required argument "plan" in addPlanToCart(plan, product)'));if(!p||!p.id)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-plan-to-cart - addPlanToCart",missingParams:["product"]},sdkName:"extend-sdk-client-shopify-addon"}),void P(new Error('Missing required argument "product" in addPlanToCart(plan, product)'));p.name||(console.warn("product.name was not defined. This will effect how the warranty is displayed in the cart, but will not effect functionality.  You can provide your own product.name property for the currently selected variant to prevent this issue."),p.name="Covered Product");if(void 0===window.Extend)return void P(new Error('Missing required dependency "Extend"'));var b=window.Extend.config(),E=b.storeId,x=b.environment;if(!E)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-plan-to-cart - addPlanToCart",missingParams:["storeId"]},sdkName:"extend-sdk-client-shopify-addon"}),void P(new Error('Could not find "storeId". Did you forget to call Extend.config()?'));(0,u.getOfferSyncType)(E,x).then((function(e){e===d.OfferSyncType.pricePoints?(0,c.getPricePointVariant)(l.price).then((function(e){var t={"_Extend.IsPricePoint":!0,"_Extend.PlanId":l.planId,"_Extend.ProductId":p.id,Product:p.name||"Covered Product",Term:(0,s.getTermLengthText)(l.term)};(0,r.addVariantToCart)(p,l,e.id,m,y,t).then((function(){P(null)})).catch(P),window.Extend.trackOfferAddedToCart({productId:p.id,planId:l.planId,warrantyQuantity:Number(m)||1,productQuantity:Number(m)||1,offerType:h})})).catch((function(e){(0,a.dispatchErrorEvent)({type:"shopify_api_error",sdkName:"extend-sdk-client-shopify-addon",error:{functionContext:"extend-shopify/add-plan-to-cart - getPricePointVariant",message:"Could not find price point variant"}}),P(e)})):(0,i.getPlanVariant)({termLength:l.term,referenceId:p.id},(function(e,t){!e&&t?((0,r.addVariantToCart)(p,l,t.variantId,m,y).then((function(){P(null)})).catch(P),window.Extend.trackOfferAddedToCart({productId:p.id,planId:l.planId,warrantyQuantity:Number(m)||1,productQuantity:Number(m)||1,offerType:h})):P(e)}))}))},t.isCartOpts=f;var r=n(3),o=n(0),i=n(17),a=n(1),u=n(11),c=n(38),d=n(5),s=n(14);function f(e){return Boolean(e&&e.plan)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanVariant=function(e,t){var n,a,u=(0,o.wrapCallback)(t);if(!e||0===Object.keys(e).length)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/get-plan-variant - getPlanVariant",missingParams:["options"]},sdkName:"extend-sdk-client-shopify-addon"}),void u(new Error("Missing argument: options"));if(e.storeId)n=e.storeId,a=e.environment||"production";else{if(void 0===window.Extend)return void u(new Error('Missing required dependency "Extend"'));var c=window.Extend.config();n=c.storeId,a=e.environment||c.environment}n?(0,r.getPlanVariantByReferenceInfo)(n,e,a).then((function(e){return u(null,e)})).catch(u):((0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/get-plan-variant - getPlanVariant",missingParams:["storeId"]},sdkName:"extend-sdk-client-shopify-addon"}),u(new Error('Could not find "storeId". Did you forget to call Extend.config()?')))};var r=n(37),o=n(0),i=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCurrency=function(e){var t=(e/100).toFixed(2);return"".concat(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCartUpdates=d,t.sortByPrice=f,t.normalizeCart=void 0;var r,o=(r=n(7))&&r.__esModule?r:{default:r},i=n(3),a=n(20),u=n(5),c=n(2);function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},r={};return(0,c.extendOfferTypeFromConfig)().then((function(o){if(o===u.OfferSyncType.pricePoints){var i=l(e.items,!0);n=i.products,r=i.updates}else{var a=l(e.items,!1);n=a.products,r=a.updates}return Object.keys(n).map((function(e){return n[e]})).forEach((function(e){if(e.leadQuantity&&e.leadProductKey&&(e.quantity>e.leadQuantity||t&&e.quantity!==e.leadQuantity))r[e.leadProductKey]=e.leadQuantity;else if(!e.warrantyQuantity||e.quantity){if(e.shippingProtectionPlans.length){var n=window.Extend.shippingProtection.getShippingQuote();e.shippingProtectionPlans.forEach((function(e){!n||e.price===n.premium&&e.properties["Extend.ShippingQuoteId"]===n.id?e.quantity>1&&(r[e.key]=1):r[e.key]=0}))}var o=e.warrantyQuantity-e.quantity;if(0!==o){var i=e.warranties.sort(f);if(o<0){if(t&&i.length){var a=i[i.length-1];r[a.key]=a.quantity-o}}else i.forEach((function(e){if(0!==o){var t=Math.max(0,o-e.quantity),n=o-t;r[e.key]=e.quantity-n,o=t}}))}}else e.warranties.forEach((function(e){r[e.key]=0}))})),{updates:Object.keys(r).length?r:null,cart:e}}))}function s(e){return Boolean(e.properties&&e.properties["__Extend.IsExtendWarranty"]&&!e.properties["Extend.LeadToken"])}function f(e,t){return e.price-t.price}function l(e,t){var n={},r={};return e.forEach((function(e){var o=function(e,t){if(s(e)&&e.sku)return t?e.properties["_Extend.ProductId"]:(0,a.parseWarrantySku)(e.sku).referenceId;return String(e.variant_id)}(e,t),i=e.properties&&e.properties["Extend.LeadToken"]||o,u=n[i]||{quantity:0,warrantyQuantity:0,warranties:[],shippingProtectionPlans:[]};s(e)?(u.warrantyQuantity+=e.quantity,u.warranties.push(e)):!function(e){return Boolean(e.properties&&e.properties["Extend.IsShippingProtection"])}(e)?(u.quantity+=e.quantity,e.properties&&e.properties["Extend.LeadQuantity"]&&(u.leadQuantity=Number(e.properties["Extend.LeadQuantity"]),u.leadProductKey=e.key)):u.shippingProtectionPlans.push(e),n[i]=u,function(e,t){if("Extend"!==e.vendor)return!1;if(t)return!e.properties||!(e.properties["_Extend.ProductId"]||e.properties["Extend.IsShippingProtection"]);return!(e.properties&&e.properties["Extend.IsShippingProtection"]||e.properties&&e.properties["__Extend.IsExtendWarranty"])}(e,t)&&(r[e.key]=0)})),{products:n,updates:r}}t.normalizeCart=function(e,t){var n,r,a,u=!1,c=!0;a=e,Boolean(a&&a.constructor===Object)?(u=Boolean(e.balance),t&&(n=t),e.cart&&(r=o.default.resolve(e.cart)),void 0!==e.update&&(c=e.update)):e&&(n=e);var s=function(e,t){e&&console.error(e),"function"==typeof n&&n(e,t)};void 0!==window.Extend?(r||(0,i.getCart)()).then((function(e){return d(e,u)})).then((function(e){return c&&e.updates?("function"==typeof c?c:i.updateCartItems)(e.updates).then((function(t){return{updates:e.updates,cart:t}})):{updates:e.updates,cart:e.cart}})).then((function(e){return s(null,e)})).catch(s):s(new Error('Missing required dependency "Extend"'))}},function(e,t,n){"use strict";function r(e){var t=e.lastIndexOf("-"),n=parseInt(e.substring(t+1),10);return{planId:e.substring(0,t),referenceId:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseWarrantySku=r,t.parseWarrantySkuOrUndefined=function(e){var t;try{t=e?r(e):void 0}catch(e){t=void 0}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterMerchantLineItems=function(e){return 0===e.length?[]:e.reduce((function(e,t){return null!==t.properties&&t.properties&&(!t.properties||t.properties["Extend.IsShippingProtection"]||t.properties["__Extend.IsExtendWarranty"])||e.push({referenceId:t.id.toString(),quantity:t.quantity,purchasePrice:t.price,productName:t.title}),e}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ExtendShopify",{enumerable:!0,get:function(){return r.ExtendShopify}}),Object.defineProperty(t,"ExtendShopifyInterface",{enumerable:!0,get:function(){return r.ExtendShopifyInterface}});var r=n(23)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ExtendShopifyInterface",{enumerable:!0,get:function(){return r.ExtendShopifyInterface}}),Object.defineProperty(t,"ExtendShopify",{enumerable:!0,get:function(){return r.ExtendShopify}});var r=n(24)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendShopify=void 0;var r=n(25),o=n(39),i=n(41),a=n(42),u=n(45),c=n(46),d=n(48),s=n(49),f=n(1),l=n(50),p=n(52),y=n(54),h={getVersion:s.getVersion,addPlanToCart:r.addPlanToCart,normalizeCart:o.normalizeCart,getPlanVariant:i.getPlanVariant,handleAddToCart:a.handleAddToCart,warrantyAlreadyInCart:u.warrantyAlreadyInCart,addSpPlanToCart:c.addSpPlanToCart,shippingProtectionInCart:d.shippingProtectionInCart,updateSpPlanInCart:l.updateSpPlanInCart,updateExtendLineItems:p.updateExtendLineItems,spCartMapper:y.spCartMapper};t.ExtendShopify=h,window.addEventListener("error",(function(e){e.filename.indexOf("extend-sdk-client-shopify-addon.")>=0&&(0,f.dispatchErrorEvent)({type:"uncaught_exception",error:{name:e.type,message:e.message,stackTrace:e.error.stack},sdkName:"extend-sdk-client-shopify-addon"})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPlanToCart=function(e,t,n){var u=(0,a.wrapCallback)(n),c={1:o.addPlanToCart,2:i.addPlanToCart};(0,r.extendVersionFromConfig)().then((function(r){c[r]&&c[r](e,t,n)})).catch(u)};var r=n(2),o=n(13),i=n(16),a=n(0)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){var t="function"==typeof Map?new Map:void 0;return(i=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return a(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function a(e,t,n){return(a=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&c(o,n.prototype),o}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendSdkExtendConfiguration=t.ExtendSdkExtendConfigurationGateway=void 0;var p=function(){function e(){s(this,e)}return l(e,[{key:"loadConfiguration",value:function(){this.assertExtendDependency();var e=window.Extend;return new y(e.config())}},{key:"assertExtendDependency",value:function(){if(void 0===window.Extend)throw new h('Missing required dependency "Extend"')}}]),e}();t.ExtendSdkExtendConfigurationGateway=p;var y=function(){function e(t){var n,r,o;s(this,e),o=void 0,(r="config")in(n=this)?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.config=t,this.assertValid()}return l(e,[{key:"storeId",value:function(){return this.config.storeId}},{key:"assertValid",value:function(){if(null===this.config)throw new h("extendConfig cannot be null");if(!this.config.storeId)throw new h("extendConfig.storeId cannot be null")}}]),e}();t.ExtendSdkExtendConfiguration=y;var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(i,e);var t,n,r=(t=i,n=u(),function(){var e,r=d(t);if(n){var i=d(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return o(this,e)});function i(e){return s(this,i),r.call(this,"Illegal Argument: ".concat(e))}return i}(i(Error))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendSdkOfferConfiguration=t.ExtendSdkOfferConfigurationGateway=void 0;var o=n(11),i=n(5);function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)})(e)}function c(e,t,n){return(c=d()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&s(o,n.prototype),o}).apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}var m=function(){function e(){p(this,e)}return h(e,[{key:"loadConfiguration",value:function(e){this.assertExtendDependency(),this.assertValidStoreId(e);var t=window.Extend,n=t.config();if(!n)throw new Error("Fetching Extend config failed");var r=n.environment;return t.getConfiguration(e).then((function(t){return 1===t.platformMetaData.extendVersion?{syncType:i.OfferSyncType.directMap,configuration:t}:(0,o.getOfferSyncType)(e,r).then((function(e){return{syncType:e,configuration:t}}))})).then((function(e){var t=e.syncType,n=e.configuration;return new v(n,t)})).catch((function(e){throw e}))}},{key:"assertExtendDependency",value:function(){if(void 0===window.Extend)throw new g('Missing required dependency "Extend"')}},{key:"assertValidStoreId",value:function(e){if(!e)throw new g("storeId cannot be null or blank")}}]),e}();t.ExtendSdkOfferConfigurationGateway=m;var v=function(){function e(t,n){p(this,e),l(this,"config",void 0),l(this,"offersType",void 0),this.config=t,this.offersType=n,this.assertValid()}return h(e,[{key:"platformMetaData",value:function(){return this.config.platformMetaData||{extendVersion:1}}},{key:"extendVersion",value:function(){return this.platformMetaData().extendVersion||1}},{key:"getOffersType",value:function(){return this.offersType}},{key:"assertValid",value:function(){if(null===this.config)throw new g("extendConfig cannot be null")}}]),e}();t.ExtendSdkOfferConfiguration=v;var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(o,e);var t,n,r=(t=o,n=d(),function(){var e,r=f(t);if(n){var o=f(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return a(this,e)});function o(e){return p(this,o),r.call(this,"Illegal Argument: ".concat(e))}return o}(u(Error))},function(e,t,n){"use strict";(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(29),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||void 0,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||void 0}).call(this,n(12))},function(e,t,n){"use strict";(function(e,t){!function(e,n){if(!e.setImmediate){var r,o,i,a,u,c=1,d={},s=!1,f=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){y(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){y(e.data)},r=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){y(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(y,0,e)}:(a="setImmediate$"+Math.random()+"$",u=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&y(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",u,!1):e.attachEvent("onmessage",u),r=function(t){e.postMessage(a+t,"*")}),l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return d[c]=o,r(c),c++},l.clearImmediate=p}function p(e){delete d[e]}function y(e){if(s)setTimeout(y,0,e);else{var t=d[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),s=!1}}}}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(this,n(12),n(30))},function(e,t,n){"use strict";var r,o,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var d,s=[],f=!1,l=-1;function p(){f&&d&&(f=!1,d.length?s=d.concat(s):l=-1,s.length&&y())}function y(){if(!f){var e=c(p);f=!0;for(var t=s.length;t;){for(d=s,s=[];++l<t;)d&&d[l].run();l=-1,t=s.length}d=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new h(e,t)),1!==s.length||f||c(y)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))};t.default=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){return new this((function(t,n){if(!e||void 0===e.length)return n(new TypeError(r(e)+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var i=o.length;function a(e,n){if(n&&("object"===r(n)||"function"==typeof n)){var u=n.then;if("function"==typeof u)return void u.call(n,(function(t){a(e,t)}),(function(n){o[e]={status:"rejected",reason:n},0==--i&&t(o)}))}o[e]={status:"fulfilled",value:n},0==--i&&t(o)}for(var u=0;u<o.length;u++)a(u,o[u])}))};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreIntegrationConfigCache=o,t.setStoreIntegrationConfigCache=function(e,t){o(e)&&i(e);r.set(e,t)},t.removeStoreIntegrationConfigCache=i,t.storeIntegrationConfigCache=void 0;var r=new(n(34).Cache)({storageKey:"extend-store-integration-config",maxItems:1});function o(e){return r.get(e)}function i(e){r.unset(e)}t.storeIntegrationConfigCache=r},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=t.DEFAULT_MAX_ITEMS=void 0;t.DEFAULT_MAX_ITEMS=50;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"storageKey",void 0),o(this,"ttl",void 0),o(this,"maxItems",void 0),o(this,"memcache",void 0),this.storageKey=t.storageKey,this.ttl=t.ttl||6e5,this.maxItems=t.maxItems||50}var t,n,i;return t=e,(n=[{key:"get",value:function(e){return this.load(),null==this.memcache[e]?null:Date.now()>this.memcache[e].createdAt+this.ttl?(this.unset(e),null):this.memcache[e].data}},{key:"set",value:function(e,t){this.load(),this.memcache[e]=this.memcache[e]||{data:t,createdAt:Date.now()},this.size()>this.maxItems&&this.unset(Object.keys(this.memcache)[0]),this.save()}},{key:"unset",value:function(e){delete this.memcache[e],this.save()}},{key:"size",value:function(){return Object.keys(this.memcache).length}},{key:"save",value:function(){var e=JSON.stringify(this.memcache||{});sessionStorage.setItem(this.storageKey,e)}},{key:"load",value:function(){var e=sessionStorage.getItem(this.storageKey);if(null!=e)try{this.memcache=JSON.parse(e)}catch(e){this.clear()}else this.memcache={}}},{key:"clear",value:function(){this.memcache={},sessionStorage.removeItem(this.storageKey)}}])&&r(t.prototype,n),i&&r(t,i),e}();t.Cache=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtendApiHost=function(e){return"replacementssandbox"===e?"api-replacementssandbox.helloextend.com":"platformsandbox"===e?"api-platformsandbox.helloextend.com":"partnerssandbox"===e?"api-partnerssandbox.helloextend.com":"acceptance"===e?"api-acceptance.helloextend.com":"development"===e?"api-dev.helloextend.com":"stage"===e?"api-stage.helloextend.com":"demo"===e?"api-demo.helloextend.com":"offerssandbox"===e?"api-offerssandbox.helloextend.com":"solutionssandbox"===e?"api-solutionssandbox.helloextend.com":"enterprisesandbox"===e?"api-enterprisesandbox.helloextend.com":"api.helloextend.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanVariantByPlanInfo=function(e,t,n){var a=t.price,u=t.planId;if(a&&u){var c=btoa(JSON.stringify({storeId:e,price:a,planId:u})),d="https://".concat(i(n),"/offers/").concat(c);return(0,r.request)(d,{extendRequest:!0}).then((function(e){var t=e.data;if(!t||!t.variantId)throw new Error("Unable to retrieve warranty variantId");return t}))}throw(0,o.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"api/shopint - getPlanVariantInfo",missingParams:["price","planId"]},sdkName:"extend-sdk-client-shopify-addon"}),new Error("Missing required plan details for request")},t.getShopintApiHost=i;var r=n(4),o=n(1);function i(e){return"replacementssandbox"===e?"shopify-replacementssandbox.helloextend.com":"platformsandbox"===e?"shopify-platformsandbox.helloextend.com":"partnerssandbox"===e?"shopify-partnerssandbox.helloextend.com":"acceptance"===e?"shopify-acceptance.helloextend.com":"development"===e?"shopify-dev.helloextend.com":"stage"===e?"shopify-stage.helloextend.com":"demo"===e?"shopify-demo.helloextend.com":"solutionssandbox"===e?"shopify-solutionssandbox.helloextend.com":"enterprisesandbox"===e?"shopify-enterprisesandbox.helloextend.com":"shopify.helloextend.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanVariantByReferenceInfo=function(e,t,n){var a=t.referenceId,u=t.termLength;if(a&&u){var c=btoa(JSON.stringify({storeId:e,referenceId:a,termLength:u})),d="https://".concat(i(n),"/planVariants/").concat(c);return(0,r.request)(d,{extendRequest:!0}).then((function(e){var t=e.data;if(!t||!t.variantId)throw new Error("Unable to retrieve warranty variantId");return t}))}throw(0,o.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"api/shopint - getPlanVariantInfo",missingParams:["referenceId","termLength"]},sdkName:"extend-sdk-client-shopify-addon"}),new Error("Missing required reference details for request")},t.getShopint2ApiHost=i;var r=n(4),o=n(1);function i(e){return"replacementssandbox"===e?"integ-shopint-replacementssandbox.extend.com":"platformsandbox"===e?"integ-shopint-platformsandbox.extend.com":"partnerssandbox"===e?"integ-shopint-partnerssandbox.extend.com":"acceptance"===e?"integ-shopint-acceptance.extend.com":"offerssandbox"===e?"integ-shopint-offerssandbox.extend.com":"development"===e?"integ-shopint-dev.extend.com":"stage"===e?"integ-shopint-stage.extend.com":"demo"===e?"integ-shopint-demo.extend.com":"solutionssandbox"===e?"integ-shopint-solutionssandbox.extend.com":"enterprisesandbox"===e?"integ-shopint-enterprisesandbox.extend.com":"integ-shopint.extend.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPricePointVariant=function(e){var t=u(e);return(0,o.getProduct)(t).then((function(t){var n,o,u=t.variants.filter((function(t){return t.price===(0,i.formatCurrency)(e)})),c=(o=1,function(e){if(Array.isArray(e))return e}(n=u)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(n,o)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];if(!c)throw(0,r.dispatchErrorEvent)({type:"invalid_price_point",error:{functionContext:"lib/price-point-variants - getPricePointVariant"},sdkName:"extend-sdk-client-shopify-addon"}),new Error("Price point variant not found in retrieved parent product");return c}))},t.getPricePointVariantHandle=u;var r=n(1),o=n(3),i=n(18);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){if(e<5e3)return"extend-protection-plans-1";if(e>=5e3&&e<5e5)return"extend-protection-plans-2";if(e>=5e5&&e<=5e6)return"extend-protection-plans-3";throw(0,r.dispatchErrorEvent)({type:"invalid_price_point",error:{functionContext:"lib/price-point-variants - getPricePointVariantHandle"},sdkName:"extend-sdk-client-shopify-addon"}),new Error("Price point not supported")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeCart=void 0;var r=n(2),o=n(40),i=n(19),a=n(0);t.normalizeCart=function(e,t){var n=(0,a.wrapCallback)(t),u={1:o.normalizeCart,2:i.normalizeCart};(0,r.extendVersionFromConfig)().then((function(n){u[n]&&u[n](e,t)})).catch(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortByPrice=u,t.normalizeCart=void 0;var r,o=(r=n(7))&&r.__esModule?r:{default:r},i=n(8);function a(e){return Boolean(e.properties&&e.properties.Ref&&!e.properties["Extend.LeadToken"])}function u(e,t){return e.price-t.price}t.normalizeCart=function(e,t){var n,r,c,d=!1,s=!0;c=e,Boolean(c&&c.constructor===Object)?(d=Boolean(e.balance),t&&(n=t),e.cart&&(r=o.default.resolve(e.cart)),void 0!==e.update&&(s=e.update)):e&&(n=e);var f=function(e,t){e&&console.error(e),"function"==typeof n&&n(e,t)};void 0!==window.Extend?(r||(0,i.getCart)()).then((function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},r={};return e.items.forEach((function(e){var t=a(e)?e.properties.Ref:String(e.variant_id),o=n[t]||{quantity:0,warrantyQuantity:0,warranties:[]};a(e)?(o.warrantyQuantity+=e.quantity,o.warranties.push(e)):(o.quantity+=e.quantity,e.properties&&e.properties["Extend.LeadQuantity"]&&(o.leadQuantity=Number(e.properties["Extend.LeadQuantity"]),o.leadProductKey=e.key)),n[t]=o,"Extend"!==e.vendor||e.properties&&e.properties.Ref||(r[e.key]=0)})),Object.keys(n).map((function(e){return n[e]})).forEach((function(e){if(e.leadQuantity&&e.leadProductKey&&(e.quantity>e.leadQuantity||t&&e.quantity!==e.leadQuantity))r[e.leadProductKey]=e.leadQuantity;else if(!e.warrantyQuantity||e.quantity){var n=e.warrantyQuantity-e.quantity;if(0!==n){var o=e.warranties.sort(u);if(n<0){if(t&&o.length){var i=o[o.length-1];r[i.key]=i.quantity-n}}else o.forEach((function(e){if(0!==n){var t=Math.max(0,n-e.quantity),o=n-t;r[e.key]=e.quantity-o,n=t}}))}}else e.warranties.forEach((function(e){r[e.key]=0}))})),Object.keys(r).length?r:null}(e,d);return s&&t?("function"==typeof s?s:i.updateCartItems)(t).then((function(e){return{updates:t,cart:e}})):{updates:t,cart:e}})).then((function(e){return f(null,e)})).catch(f):f(new Error('Missing required dependency "Extend"'))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanVariant=function(e,t){var n=(0,a.wrapCallback)(t),u={1:o.getPlanVariant,2:i.getPlanVariant};(0,r.extendVersionFromConfig)().then((function(n){u[n]&&u[n](e,t)})).catch(n)};var r=n(2),o=n(15),i=n(17),a=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAddToCart=function(e,t){var n=(0,r.wrapCallback)(t.done),u={1:i.handleAddToCart,2:a.handleAddToCart};(0,o.extendVersionFromConfig)().then((function(n){u[n]&&u[n](e,t)})).catch(n)};var r=n(0),o=n(2),i=n(43),a=n(44)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAddToCart=function(e,t){var n=t.modal,i=void 0===n||n,a=t.quantity,u=void 0===a?1:a,c=t.done,d=(0,o.wrapCallback)(c);if(void 0===window.Extend)return void d(new Error('Missing required dependency "Extend"'));var s=window.Extend.buttons.instance(e);if(!s)return void d();var f=s.getPlanSelection(),l=s.getActiveProduct();if(f&&l)return void(0,r.addPlanToCart)({plan:f,product:l,quantity:u,offerType:{area:"product_page",component:"buttons"}},d);if(!i||!l)return void d();window.Extend.modal.open({referenceId:l.id,onClose:function(e,t){e&&t?(0,r.addPlanToCart)({plan:e,product:t,quantity:u,offerType:{area:"product_page",component:"modal"}},d):d()}})};var r=n(13),o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAddToCart=function(e,t){var n=t.modal,i=void 0===n||n,a=t.quantity,u=void 0===a?1:a,c=t.done,d=(0,o.wrapCallback)(c);if(void 0===window.Extend)return void d(new Error('Missing required dependency "Extend"'));var s=window.Extend.buttons.instance(e);if(!s)return void d();var f=s.getPlanSelection(),l=s.getActiveProduct();if(f&&l)return void(0,r.addPlanToCart)({plan:f,product:l,quantity:u,offerType:{area:"product_page",component:"buttons"}},d);if(!i||!l)return void d();window.Extend.modal.open({referenceId:l.id,onClose:function(e,t){e&&t?(0,r.addPlanToCart)({plan:e,product:t,quantity:u,offerType:{area:"product_page",component:"modal"}},d):d()}})};var r=n(16),o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warrantyAlreadyInCart=function(e,t){var n=[];e||(console.warn('Missing required argument "variantId" in warrantyAlreadyInCart(variantId, cartItems)'),n.push("variantId"));t||(console.warn('Missing required argument "cartItems" in warrantyAlreadyInCart(variantId, cartItems)'),n.push("cartItems"));if(n.length)return(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/warranty-in-cart - warrantyAlreadyInCart",missingParams:n},sdkName:"extend-sdk-client-shopify-addon"}),!0;return t.filter((function(t){var n=t.properties;if(!n)return!1;var r=n.Ref&&n.Ref.toString()===e,i=n["__Extend.IsExtendWarranty"]&&t.sku&&(0,o.parseWarrantySku)(t.sku).referenceId.toString()===e,a=n["_Extend.ProductId"]&&n["_Extend.ProductId"].toString()===e;return r||i||a})).length>0};var r=n(1),o=n(20)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSpPlanToCart=function(e){var t=(0,i.wrapCallback)(e.callback),n={2:o.addSpPlanToCart};(0,r.extendVersionFromConfig)().then((function(t){n[t]&&n[t](e)})).catch(t)};var r=n(2),o=n(47),i=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSpPlanToCart=function(e){var t=e.callback,n=e.quote,d=e.cart,s=(0,o.wrapCallback)(t);if(!n||!Object.keys(n).length)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/add-sp-plan-to-cart - addSpPlanToCart",missingParams:["plan"]},sdkName:"extend-sdk-client-shopify-addon"}),void s(new Error('Missing required argument "quote" in addSpPlanToCart(quote)'));if(d&&!(0,a.isSPPlanChangeRequired)(d,n))return void s(null,{isAdded:!1});(0,c.getSPPlanVariant)(n).then((function(e){(0,r.addShippingProtectionToCart)(e,n.id).then((function(){s(null,{isAdded:!0}),(0,r.getCart)().then((function(e){window.Extend.trackSPOfferAddedToCart({items:e.items,quote:n,message:u.SP_PLAN_ADDED_TO_CART})})).catch((function(){window.Extend.trackSPOfferAddedToCart({items:[],quote:n,message:u.SP_PLAN_ADDED_TO_CART})}))})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))};var r=n(3),o=n(0),i=n(1),a=n(9),u=n(6),c=n(10)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shippingProtectionInCart=function(e){if(!e||!e.length)return console.warn('Missing required argument "cartItems" in shippingProtectionInCart(variantId, cartItems)'),(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/shipping-protection-in-cart - shippingProtectionInCart",missingParams:["cartItems"]},sdkName:"extend-sdk-client-shopify-addon"}),!1;return e.some((function(e){var t=e.properties;return t&&t["Extend.IsShippingProtection"]}))};var r=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersion=function(){return"1.6.49"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateSpPlanInCart=function(e){var t=(0,r.wrapCallback)(e.callback),n={2:i.updateSpPlanInCart};(0,o.extendVersionFromConfig)().then((function(t){n[t]&&n[t](e)})).catch(t)};var r=n(0),o=n(2),i=n(51)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateSpPlanInCart=function(e){var t,n=(0,c.wrapCallback)(e.callback);null!=e&&e.cart&&(t=Promise.resolve(e.cart));if(void 0===window.Extend)return void n(new Error('Missing required dependency "Extend"'),{isUpdated:!1});(t||(0,i.getCart)()).then((function(t){(function(e){return new Promise((function(t,n){return(0,o.isSPInCart)(e.cart)?"remove"===e.action?d(e).then((function(n){var r;r=s(n)?n:e.cart,t({isUpdated:!0,message:"Shipping Protection Plan removed from Cart!"}),window.Extend.trackSPOfferRemovedFromCart({items:r.items,quote:e.quote,message:a.SP_PLAN_REMOVED_FROM_CART_BY_USER})})).catch(n):"update"===e.action?function(e){var t=e.quote,n=e.cart;if(!t||0===t.premium)return d(e);if(!(0,o.isSPPlanChangeRequired)(n,t))return Promise.resolve({isUpdated:!1,message:"Nothing to update!"});return d(e).then((function(n){var o;return o=s(n)?n:e.cart,window.Extend.trackSPOfferRemovedFromCart({items:o.items,quote:e.quote,message:a.SP_PLAN_REMOVED_FROM_CART_FOR_UPDATE}),(0,u.getSPPlanVariant)(t).then((function(n){return window.Extend.shippingProtection.setSPUserConfig({isUserOptOut:!1}),(0,r.addShippingProtectionToCart)(n,t.id).then((function(n){var r=e.cart;return n.data&&(r=n.data),window.Extend.trackSPOfferAddedToCart({items:r.items,quote:t,message:a.SP_PLAN_ADDED_TO_CART_FOR_UPDATE}),n}))}))}))}(e).then((function(e){e&&t("isUpdated"in e?{isUpdated:e.isUpdated,message:e.message}:{isUpdated:!0,message:"Shipping Protection Plan updated!"})})).catch(n):t({isUpdated:!1,message:"Nothing to update!"}):t({isUpdated:!1,message:"Nothing to update!"})}))})({cart:t,action:e.action,quote:e.quote}).then((function(e){n(null,e)})).catch(n)})).catch(n)},t.isCart=s;var r=n(3),o=n(9),i=n(8),a=n(6),u=n(10),c=n(0);function d(e){var t={},n=(0,o.filterShippingPlans)(e.cart);return 0===n.length?(window.Extend.shippingProtection.setSPUserConfig({isUserOptOut:!0}),Promise.resolve({isUpdated:!0,message:"Nothing to update!"})):(n.forEach((function(e){t[e.key]=0})),(0,r.updateCartItems)(t))}function s(e){return void 0!==e.items}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtendLineItems=function(e){var t=(0,r.wrapCallback)(e.callback),n={2:i.updateExtendLineItems};(0,o.extendVersionFromConfig)().then((function(t){n[t]&&n[t](e)})).catch(t)};var r=n(0),o=n(2),i=n(53)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtendLineItems=function(e){var t=(0,c.wrapCallback)(e.callback);if(void 0===window.Extend)return void t(new Error('Missing required dependency "Extend"'));(0,r.getCart)().then((function(n){var u=(0,a.filterMerchantLineItems)(n.items);return(0,i.getSPQuote)(u).then((function(a){var u=a.quote,c=a.attachBehavior;return y({quote:u,attachBehavior:c,cart:n}).then((function(a){var c=a;void 0!==e.isSPSupported&&(c=function(e,t){var n=e;if(!1===t){e.additions&&(n.additions=null);var r=(0,i.filterShippingPlans)(e.cart),o={};r.length>0&&(r.forEach((function(e){o[e.key]=0})),n.updates=o)}return n}(a,e.isSPSupported));var s=c,l=s.updates,p=s.additions;return(0,o.getCartUpdates)(n,e.balanceCart).then((function(e){var o=e.updates;return function(e){var t=e.normalizeUpdates,n=e.SPUpdates,o=e.SPAdditions,i=e.initialCart,a=e.callback,u=f(f({},t),n);return new Promise((function(c,s){return null===t&&null===n&&null===o?c(a(null,{cart:i,updates:null,additions:null})):(t||n)&&null===o?(0,r.updateCartItems)(u).then((function(t){if(n){var r=e.quote;window.Extend.trackSPOfferRemovedFromCart({items:t.items,quote:r,message:d.SP_PLAN_REMOVED_FROM_CART_BY_USER})}return c(a(null,{cart:t,updates:u,additions:o}))})).catch(s):null===t&&null===n&&o?(0,r.addShippingProtectionToCartUpdated)(o.variantId,o.quoteId).then((function(){return(0,r.getCart)().then((function(t){var n=e.quote;return window.Extend.trackSPOfferAddedToCart({items:t.items,quote:n,message:d.SP_PLAN_ADDED_TO_CART_FOR_UPDATE_EXTEND_LINE_ITEMS}),c(a(null,{cart:t,updates:null,additions:o}))}))})).catch(s):(t||n)&&o?(0,r.updateCartItems)(u).then((function(){return(0,r.addShippingProtectionToCartUpdated)(o.variantId,o.quoteId).then((function(){return(0,r.getCart)().then((function(t){var r=e.quote;return n&&window.Extend.trackSPOfferRemovedFromCart({items:t.items,quote:r,message:d.SP_PLAN_REMOVED_FROM_CART_FOR_UPDATE}),window.Extend.trackSPOfferAddedToCart({items:t.items,quote:r,message:d.SP_PLAN_ADDED_TO_CART_FOR_UPDATE_EXTEND_LINE_ITEMS}),c(a(null,{cart:t,updates:u,additions:o}))}))}))})).catch(s):c(a(null,{cart:i,updates:null,additions:null}))}))}({callback:t,initialCart:n,SPAdditions:p,SPUpdates:l,normalizeUpdates:o,quote:u})}))}))}))})).catch(t)},t.handleAttachBehavior=y;var r=n(3),o=n(19),i=n(9),a=n(21),u=n(10),c=n(0),d=n(6);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=e.cart,n=e.action,r=e.quote,o={};return(0,i.filterShippingPlans)(t).forEach((function(e){o[e.key]=0})),new Promise((function(e,i){if(!r)return e({additions:null,cart:t,updates:o});switch(n){case"update":return(0,u.getSPPlanVariant)(r).then((function(n){return e({additions:{variantId:n,quoteId:r.id},cart:t,updates:o})})).catch(i);case"add":return(0,u.getSPPlanVariant)(r).then((function(n){return e({additions:{variantId:n,quoteId:r.id},cart:t,updates:null})})).catch(i);default:return e({additions:null,cart:t,updates:null})}}))}function y(e){var t=e.cart,n=e.quote,r=e.attachBehavior;return new Promise((function(e){if(!n&&(0,i.isSPInCart)(t))return e(p({cart:t,quote:null}));if(n){if(!(0,i.isSPPlanChangeRequired)(t,n))return e({cart:t,updates:null,additions:null});if(0===n.premium&&(0,i.isSPInCart)(t))return e(p({cart:t,quote:null}));var o=window.Extend.shippingProtection.getSPUserConfig();if(null!=o&&o.isUserOptOut)return e({cart:t,updates:null,additions:null});if((0,i.isSPInCart)(t))return e(p({cart:t,quote:n,action:"update"}));if("OPT_IN"===r)return e({cart:t,updates:null,additions:null});if("OPT_MERCHANT"===r||"OPT_OUT"===r)return e(p({cart:t,quote:n,action:"add"}))}return e({cart:t,updates:null,additions:null})}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spCartMapper=function(e){if(!e||!e.length)return console.warn('Missing required argument "cartItems" in spCartMapper(cartItems)'),(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-shopify/shipping-protection-cart-mapper - spCartMapper",missingParams:["cartItems"]},sdkName:"extend-sdk-client-shopify-addon"}),[];return(0,o.filterMerchantLineItems)(e)};var r=n(1),o=n(21)}]).ExtendShopify}));